{% extends 'base.html' %}

{% load static %}
{% load sass_tags %}

{% block css %}
<!-- Plugins css start-->
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/todo.scss' %}">
<!-- Plugins css Ends-->
{% endblock %}

{% block content %}

<div class="page-body">
      {% include "layout/breadcrumb.html" %}

     {% include "events/components/events_list_form.html" %}

</div>

{% endblock %}

{% block scriptcontent %}
<!-- Plugins JS start-->
    <script src="{% static 'assets/js/todo/todo.js'%}"></script>
    <script src="{% static 'assets/js/todo/todo.js'%}"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var editEventModal = document.getElementById('editEventModal');

        editEventModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget; // Кнопка, которая открыла модальное окно

            // Получаем данные из атрибутов кнопки
            var id = button.getAttribute('data-id');
            var name = button.getAttribute('data-name');
            var date = button.getAttribute('data-date');
            var direction = button.getAttribute('data-direction');
            var quantity = button.getAttribute('data-quantity');
            var age_14 = button.getAttribute('data-age_14');
            var age_35 = button.getAttribute('data-age_35');
            var age_other = button.getAttribute('data-age_other');
            var invalids = button.getAttribute('data-invalids');
            var out_of_station = button.getAttribute('data-out_of_station');
            var as_part = button.getAttribute('data-as_part');
            var paid = button.getAttribute('data-paid') === 'true'; // Преобразуем строку в булево значение
            var note = button.getAttribute('data-note');

            // Заполняем поля формы
            editEventModal.querySelector('#id_name').value = name;
            editEventModal.querySelector('#id_date').value = date;
            editEventModal.querySelector('#id_direction').value = direction;
            editEventModal.querySelector('#id_quantity').value = quantity;
            editEventModal.querySelector('#id_age_14').value = age_14;
            editEventModal.querySelector('#id_age_35').value = age_35;
            editEventModal.querySelector('#id_age_other').value = age_other;
            editEventModal.querySelector('#id_invalids').value = invalids;
            editEventModal.querySelector('#id_out_of_station').value = out_of_station;
            editEventModal.querySelector('#id_as_part').value = as_part;
            editEventModal.querySelector('#id_paid').checked = paid;
            editEventModal.querySelector('#id_note').value = note;

            // Устанавливаем скрытое поле для ID события
            editEventModal.querySelector('[name="event_id"]').value = id;

            // Устанавливаем action для формы
            editEventModal.querySelector('#eventForm').action = "{% url 'update_event' pk='0' %}".replace("0", id);
        });
    });
</script>
<!-- Plugins JS Ends-->
{% endblock %}